---
title: Azure Stack Hub で Event Hubs の容量を計画する
description: Azure Stack Hub で Event Hubs リソース プロバイダーの容量を計画する方法について説明します。
author: BryanLa
ms.author: bryanla
ms.service: azure-stack
ms.topic: how-to
ms.date: 12/09/2019
ms.reviewer: jfggdl
ms.lastreviewed: 08/15/2020
ms.openlocfilehash: 41ce43c3eda27d3ede8e6a90175fb3042fa2bf68
ms.sourcegitcommit: f56a5b287c90b2081ae111385c8b7833931d4059
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97343571"
---
# <a name="how-to-do-capacity-planning-for-event-hubs-on-azure-stack-hub"></a>Azure Stack Hub で Event Hubs のキャパシティ プランニングを行う方法

オペレーターとして、リソースに対する[クォータ](azure-stack-quota-types.md)を使用して Azure Stack Hub の容量を管理します。 Event Hubs クラスターで使用されるコアの最大数にクォータを設定することによって、Event Hubs リソースの消費を制御します。 Event Hubs クラスターは、ユーザーが Event Hubs リソースをデプロイするときに作成されます。 また、リソース プロバイダーにはさまざまなリソース消費要件がありますが、それについてもこの記事で説明します。

## <a name="cluster-resource-consumption"></a>クラスター リソースの消費量

Event Hubs のデプロイの容量消費を把握するには、ユーザーが容量ユニット (CU) に基づいて Event Hubs クラスターを作成することに注目する必要があります。 ユーザーは、Event Hubs クラスターを作成する際に CPU コア数を指定することはありません。 そうではなく、使用される具体的なコア数は各 CU によって直に決まります。 

ユーザーは、ビジネス要件を満たす CU を使用して Event Hubs クラスターを作成する必要があります。 クォータの構成について判断できるようにするために、下の表に次の情報を示します。
- 1 CU Event Hubs クラスターによって使用される合計コア数。
- VM ストレージ、メモリ、ストレージ アカウントなど、他のリソースの消費に必要なおおよその容量。

| | VM の種類 | クラスター ノード | VM またはノードあたりのコア数 | コアの合計 | VM ストレージ | メモリ | ストレージ アカウント | パブリック IP |
|-|---------|-------|-------------------|-------------|------------|--------|------------------|---|
| **1 CU Event Hubs クラスター** | [D11_V2](../user/azure-stack-vm-sizes.md#mo-dv2) | 5 | 2 | 10 | 500 GiB | 70 GiB | 4 | 1 |

すべての Event Hubs クラスターで、種類が [D11_V2](../user/azure-stack-vm-sizes.md#mo-dv2) の VM がノードに使用されます。 VM の種類 D11_V2 は、2 つのコアで構成されます。 1 CU Event Hubs クラスターで 5 つの D11_V2 VM が使用されるため、都合 10 個のコアが使用されることになります。 クォータで構成するコア数を決定する際は、1 CU で使用される合計コアの倍数を使用します。 この計算には、Event Hubs クラスターを作成するときにユーザーに使用を許可する最大 CU 数が反映されます。 たとえば、ユーザーが 2 CU の容量のクラスターを作成できるようにするクォータを構成するには、クォータを 20 コアに設定します。

[!INCLUDE [event-hubs-scale](../includes/event-hubs-scale.md)]

## <a name="resource-provider-resource-consumption"></a>リソース プロバイダーのリソース消費量  

Event Hubs リソース プロバイダーによるリソース消費量は一定であり、ユーザーが作成するクラスターの数やサイズには関係がありません。 次の表は、Azure Stack Hub での Event Hubs リソース プロバイダーによるコア使用量と、他のリソースによるおおよそのリソース消費量を示しています。 Event Hubs リソース プロバイダーでは、VM の種類として [D2_V2](../user/azure-stack-vm-sizes.md#dv2-series) をデプロイに使用します。

|                                  | VM の種類 | クラスター ノード | コア | VM ストレージ | メモリ | ストレージ アカウント | パブリック IP |
|----------------------------------|---------|---------------|-------|------------|--------|------------------|------------|
| **Event Hubs リソース プロバイダー** | D2_V2   | 3     | 6     | 300 GiB | 21 GiB | 2 | 1 |

> [!IMPORTANT]
> リソース プロバイダーの消費量は、クォータによって制御されるものではありません。 リソース プロバイダーによって使用されるコア数にクォータ構成で対応する必要はありません。 リソース プロバイダーは、管理者サブスクリプションを使用してインストールされます。 このサブスクリプションでは、必要なリソース プロバイダーをインストールする際に、オペレーターに対してリソース消費量の制限が課されません。

## <a name="total-resource-consumption"></a>合計のリソース消費量

Event Hubs サービスによって消費される合計容量には、リソース プロバイダーによるリソース使用量と、ユーザーが作成したクラスターによる消費量が含まれます。

次の表は、クォータによって管理されているかどうかに関係なく、さまざまな構成での Event Hubs の合計消費量を示しています。 これらの数値は、上に示したリソース プロバイダーと Event Hubs クラスターの消費量に基づいています。 これらの例を使用すると、これ以外のデプロイ サイズの Azure Stack Hub の合計使用量も簡単に計算できます。

|                                      | コア | VM ストレージ | メモリ  | ストレージ アカウント | ストレージの合計\* | パブリック IP\*\* |
|--------------------------------------|-------|------------|---------|------------------|---------------|------------|
| **1 CU クラスター + リソース プロバイダー** | 16    | 800 GiB    | 91 GiB  | 6                | 可変    | 2 |
| **2 CU クラスター + リソース プロバイダー** | 26    | 1.3 TB     | 161 GiB | 10               | 可変    | 2 |
| **4 CU クラスター + リソース プロバイダー** | 46    | 2.3 TB     | 301 GiB | 18               | 可変    | 2 |

\* データ ブロック (メッセージまたはイベント) の受信速度とメッセージの保持期間は、Event Hubs クラスターによって使用されるストレージの消費量に寄与する 2 つの重要な要素です。 たとえば、イベント ハブの作成時にメッセージの保持期間を 7 日に設定し、メッセージが 1 MB/秒の速度で取り込まれる場合、おおよそのストレージ消費量は 604 GB (1 MB x 60 秒 x 60 分 x 24 時間 x 7 日) となります。 保持期間が 7 日間で、20 MB/秒の速度でメッセージが送信される場合、おおよそのストレージ消費量は 12 TB となります。 ストレージ容量の消費量を完全に把握するには、必ずデータの受信速度と保持期間を考慮してください。

\*\* パブリック IP アドレスは、[サブスクリプションの一部として提供されたネットワーク クォータ](azure-stack-quota-types.md#network-quota-types)から使用されます。

## <a name="next-steps"></a>次のステップ

インストール プロセスを開始する前に、「[Azure Stack Hub に Event Hubs をインストールするための前提条件](event-hubs-rp-prerequisites.md)」を完了します。
