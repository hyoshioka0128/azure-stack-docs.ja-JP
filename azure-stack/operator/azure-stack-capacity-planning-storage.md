---
title: Azure Stack Hub ストレージ容量の計画
description: Azure Stack Hub デプロイのためのストレージ容量の計画について説明します。
author: PatAltimore
ms.topic: conceptual
ms.date: 03/04/2020
ms.author: patricka
ms.reviewer: prchint
ms.lastreviewed: 05/31/2019
ms.openlocfilehash: 69248d5a81cf3d1017f221a57549d75b205f0fc3
ms.sourcegitcommit: 733a22985570df1ad466a73cd26397e7aa726719
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/05/2021
ms.locfileid: "97871261"
---
# <a name="azure-stack-hub-storage-capacity-planning"></a>Azure Stack Hub ストレージ容量の計画

以下のセクションでは、ソリューションのストレージ ニーズに合わせて計画する場合に役立つ、Azure Stack Hub ストレージのキャパシティ プランニングに関する情報を提供します。

## <a name="uses-and-organization-of-storage-capacity"></a>ストレージ容量の使用と構成

Azure Stack Hub のハイパーコンバージド構成を使用すると、物理ストレージ デバイスを共有できます。 使用可能なストレージのうち共有可能な 3 つの主な部分は、インフラストラクチャ、テナント仮想マシン (VM) の一時ストレージ、Azure 整合ストレージ (ACS) サービスの BLOB、テーブル、キューをバックアップするストレージです。

## <a name="storage-spaces-direct-cache-and-capacity-tiers"></a>記憶域スペース ダイレクトのキャッシュ層と容量層

オペレーティング システム、ローカルのログ記録、ダンプ、およびその他の一時インフラストラクチャ ストレージのニーズに合わせて使用されるストレージ容量があります。 このローカル ストレージ容量は、記憶域スペース ダイレクト構成の管理下にあるストレージ デバイスから分離されます (デバイスと容量は別個)。 ストレージ デバイスの残りの部分は、スケール ユニット内のサーバー数に関係なく、ストレージ容量の単一のプールに配置されます。

これらのデバイスには、キャッシュと容量という 2 つの種類があります。 記憶域スペース ダイレクトでは、キャッシュの書き戻しと読み取りのためにこれらのデバイスが利用されます。 これらのキャッシュ デバイスの容量は使用されますが、フォーマット済み仮想ディスクのフォーマット済み "可視" 容量にはコミットされません。 これに対して、記憶域スペース ダイレクトでは、この目的に容量デバイスが使用され、マネージド データの "ホームの場所" が提供されます。

すべてのストレージ容量は、Azure Stack Hub インフラストラクチャによって直接割り当てられ、管理されます。 オペレーターが、構成、割り当て、容量拡張に関する選択を行う必要はありません。 Azure Stack Hub では、これらの設計上の決定は、初期インストールとデプロイ時、または容量の引き上げ時に、ソリューション要件に合わせて自動的に行われます。 Azure Stack Hub では、回復性、リビルドのための予約容量、その他の詳細は、設計の一部として考慮されます。

オペレーターは、*オール フラッシュ* ストレージ構成または *ハイブリッド* ストレージ構成を選択できます。

![Azure のストレージ容量計画の図](media/azure-stack-capacity-planning/storage.png)

オール フラッシュ構成では、2 層または 1 層の構成のいずれかにすることができます。 構成が 1 層の場合は、すべての容量デバイスが同じ種類 (*NVMe*、*SATA SSD*、*SAS SSD* など) になり、キャッシュ デバイスは使用されません。 2 層のオール フラッシュ構成では、一般的に、キャッシュ デバイスとして NVMe が使用され、容量デバイスとして SATA または SAS SSD が使用されます。

ハイブリッドの 2 層構成では、キャッシュを NVMe、SATA、SAS SSD から選択し、容量デバイスは HDD になります。

記憶域スペース ダイレクトと Azure Stack Hub ストレージ構成の簡単な概要を以下に示します。
- スケール ユニットごとに記憶域スペース ダイレクト プールが 1 つ (ストレージ デバイスはすべて単一プール内で構成されます)。
- 仮想ディスクは最適なパフォーマンスと回復性のために 3 つのコピー ミラーとして作成されます。
- 各仮想ディスクは ReFS ファイル システムとしてフォーマットされます。
- 仮想ディスク容量は、1 つの容量デバイスのデータ容量をプール内で未割り当てのままにするように計算され、割り当てられます。 つまり、サーバーごとに 1 つの容量ドライブがあることになります。
- 各 ReFS ファイル システムでは、保存データの暗号化のために BitLocker が有効になります。 

自動的に作成される仮想ディスクとその容量は次のとおりです。

|名前|容量の計算|説明|
|-----|-----|-----|
|ローカル/ブート デバイス|最小 340 GB<sup>1</sup>|オペレーティング システム イメージと "ローカル" インフラストラクチャ VM 用の個別のサーバー ストレージ。|
|インフラストラクチャ|3.5 TB|すべての Azure Stack Hub インフラストラクチャの使用量。|
|VmTemp|以下を参照<sup>2</sup>|テナント VM には一時ディスクが接続されており、そのデータはこれらの仮想ディスクに格納されます。|
|ACS|下記参照 <sup>3</sup>|BLOB、テーブル、キューを提供するための Azure 整合ストレージの容量。|

<sup>1</sup> Azure Stack Hub ソリューション パートナーの必要な最小ストレージ容量。

<sup>2</sup> テナント VM の一時ディスクに使用される仮想ディスク サイズは、サーバーの物理メモリの比率として計算されます。 一時ディスクは、VM に割り当てられた物理メモリの比率となります。 Azure Stack Hub の "一時ディスク" ストレージに対して行われる割り当てでは、ほとんどのユース ケースがキャプチャされますが、すべての一時ディスク ストレージのニーズを満たすことができない場合があります。 この比率は、一時ストレージを使用可能にすることと、一時ディスクの容量に対してのみソリューションの記憶容量の大部分が消費されないこととの間のトレードオフです。 スケール ユニット内のサーバーごとに、一時ストレージ ディスクが 1 つ作成されます。 一時ストレージの容量は、スケール ユニットのストレージ プールで利用可能なストレージ容量全体の 10% を超えることはありません。 計算は次の例のようになります。

```
  DesiredTempStoragePerServer = PhysicalMemory * 0.65 * 8
  TempStoragePerSolution = DesiredTempStoragePerServer * NumberOfServers
  PercentOfTotalCapacity = TempStoragePerSolution / TotalAvailableCapacity
  If (PercentOfTotalCapacity <= 0.1)
      TempVirtualDiskSize = DesiredTempStoragePerServer
  Else
      TempVirtualDiskSize = (TotalAvailableCapacity * 0.1) / NumberOfServers
```

<sup>3</sup> ACS で使用するために作成される仮想ディスクについては、残りの容量を単純に除算します。 前述のとおり、すべての仮想ディスクは 3 方向ミラーであり、サーバーごとに 1 つの容量ドライブ相当の容量が未割り当てとなります。 前述のさまざまな仮想ディスクが最初に割り当てられてから、残りの容量が ACS 仮想ディスクに使用されます。

## <a name="next-steps"></a>次のステップ

[Azure Stack Hub Capacity Planner](azure-stack-capacity-planner.md) について学習する。
