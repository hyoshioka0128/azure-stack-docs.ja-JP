---
title: Azure Stack Hub での正常性およびアラートの監視
description: Azure Stack Hub で正常性およびアラートを監視する方法について説明します。
author: PatAltimore
ms.topic: how-to
ms.date: 03/04/2020
ms.author: patricka
ms.lastreviewed: 01/18/2019
ms.openlocfilehash: 00357a7b16ee1ec6b158ea881d9f4a2c77d69e72
ms.sourcegitcommit: a90b146769279ffbdb09c68ca0506875a867e177
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "98123742"
---
# <a name="monitor-health-and-alerts-in-azure-stack-hub"></a>Azure Stack Hub での正常性およびアラートの監視

Azure Stack Hub には、ユーザーが Azure Stack Hub リージョンの正常性とアラートを表示できるようにする、インフラストラクチャ監視機能が含まれています。 **[リージョンの管理]** タイルには、Azure Stack Hub のすべてのデプロイ済みリージョンが一覧表示されます。 それは、既定では、既定のプロバイダー サブスクリプション用の管理者ポータルに固定されています。 タイルには、アクティブな重大アラートおよび警告アラートの数がリージョンごとに表示されます。 このタイルは、Azure Stack Hub の正常性とアラートの機能へのエントリ ポイントです。

![Azure Stack Hub 管理者ポータルの [リージョンの管理] タイル](media/azure-stack-monitor-health/image1.png)

## <a name="understand-health-in-azure-stack-hub"></a>Azure Stack Hub の正常性について

正常性リソース プロバイダーでは、正常性とアラートが管理されます。 Azure Stack Hub のインフラストラクチャ コンポーネントは、Azure Stack Hub のデプロイおよび構成の際に、正常性リソース プロバイダーに登録されます。 この登録により、各コンポーネントの正常性とアラートの表示が有効になります。 Azure Stack Hub の正常性は、単純な概念です。 コンポーネントの登録済みインスタンスのアラートが存在する場合、そのコンポーネントの正常性の状態は、アクティブなアラートの最大の重大度、つまり警告または重大を反映します。

## <a name="alert-severity-definition"></a>アラートの重大度の定義

Azure Stack Hub では、アラートは、2 つの重大度 (**警告**、または **重大**) でのみ生成されます。

- **警告**  
  オペレーターは、予定された方法で警告アラートに対処できます。 このアラートは、通常、ユーザーのワークロードに影響を及ぼしません。

- **重大**  
  オペレーターは、重大アラートには緊急で対応する必要があります。 これらのアラートは、Azure Stack Hub ユーザーに現在影響を及ぼしているか、まもなく影響を及ぼす問題があることを示しています。


## <a name="view-and-manage-component-health-state"></a>コンポーネントの正常性状態の表示および管理

コンポーネントの正常性の状態は、管理者ポータルのほか、Rest API および PowerShell で確認できます。

ポータルで正常性の状態を表示するには、 **[Region management]** \(リージョン管理) タイルで表示するリージョンをクリックします。 インフラストラクチャ ロールとリソース プロバイダーの正常性の状態を表示できます。

![インフラストラクチャ ロールのリスト](media/azure-stack-monitor-health/image2.png)

リソース プロバイダーまたはインフラストラクチャ ロールをクリックすると、詳細情報を表示できます。

> [!WARNING]  
> インフラストラクチャ ロールとロール インスタンスを順にクリックすると、 **[Start]\(起動\)** 、 **[Restart]\(再起動\)** 、または **[Shutdown]\(シャットダウン\)** のオプションが表示されます。 統合システムに更新プログラムを適用する場合は、これらのアクションを使用しないでください。 また、Azure Stack Development Kit (ASDK) 環境では、これらのオプションを使用 **しない** でください。 これらのオプションは、インフラストラクチャ ロールあたり複数のロール インスタンスが存在する統合システム環境専用に設計されています。 ASDK でロール インスタンス (特に AzS-Xrp01) を再起動すると、システムが不安定になります。 トラブルシューティングの支援のため、問題を [Azure Stack Hub フォーラム](https://aka.ms/azurestackforum)に投稿してください。
>

## <a name="view-alerts"></a>アラートを表示する

各 Azure Stack Hub リージョンのアクティブなアラートのリストは、 **[リージョンの管理]** ブレードから直接入手できます。 既定の構成の最初のタイルは **[Alerts]** \(アラート) タイルで、リージョンの重大アラートと警告アラートの概要が表示されます。 アラート タイルは、このブレードの他のタイルと同様、ダッシュボードに固定してすばやくアクセスできます。

![Azure Stack Hub 管理者ポータルの警告を表示する [アラート] タイル](media/azure-stack-monitor-health/image3.png)

 リージョンのすべてのアクティブなアラートの一覧を表示するには、 **[アラート]** タイルの上部を選択します。 フィルター処理されたアラートの一覧 ([重大] または [警告]) を表示するには、タイル内の行項目 ( **[重大]** または **[警告]** ) のいずれかを選択します。

**[Alerts]** \(アラート) ブレードは、状態 ([Active] \(アクティブ) または [Closed] \(終了)) と重大度 ([Critical] \(重大) または [Warning] \(警告)) の両方でフィルター処理する機能をサポートしています。 既定のビューには、すべてのアクティブなアラートが表示されます。 終了したアラートはすべて、7 日後にシステムから削除されます。

>[!Note]
>アラートはアクティブなままだが、1日の間に更新されていない場合は、問題が報告されていなければ、[Test-AzureStack](azure-stack-diagnostic-test.md)を実行してアラートを閉じることができます。

![Azure Stack Hub 管理者ポータルで、[重大] または [警告] ステータスでフィルター処理するためのフィルター ペイン](media/azure-stack-monitor-health/alert-view.png)

また、 **[View API]\(APIの表示\)** アクションには、リスト ビューの生成に使用された REST API が表示されます。 このアクションにより、アラートの照会に使用できる REST API 構文をすばやく理解できます。 この API は、自動化、または既存のデータ センターの監視、レポート、およびチケット発行ソリューションとの統合に使用できます。

特定のアラートをクリックすると、アラートの詳細を表示できます。 アラートの詳細には、アラートに関連付けられているすべてのフィールドが表示され、影響を受けているコンポーネントとアラートのソースにすばやく移動できます。 たとえば、インフラストラクチャ ロール インスタンスの 1 つがオフラインになるか、アクセスできない場合、次のアラートが発生します。  

![Azure Stack Hub 管理者ポータルの [アラートの詳細] ブレード](media/azure-stack-monitor-health/alert-detail.png)

## <a name="alert-remediation"></a>アラートの修復

### <a name="automated-remediation"></a>自動化された修復

一部のアラートは、前の図に示されているように、 **[修復]** オプションに対応しています。 選択すると、**[修復]** アクションによって、そのアラートに固有の手順が実行されて問題の解決が試みられます。 選択すると、 **[修復]** アクションの状態がポータルの通知として表示されます。

![アラート修復アクションが進行中](media/azure-stack-monitor-health/repair-in-progress.png)

同じポータル通知ブレードで、**[修復]** アクションの正常完了またはアクションの失敗がレポートされます。  アラートの修復アクションが失敗した場合は、アラートの詳細から **[修復]** アクションを再実行することができます。 **[修復]** アクションが正常に完了した場合は、再実行 **しないでください**。 インフラストラクチャ ロール インスタンスがオンラインに戻ると、このアラートは自動的に閉じます。

![修復アクションが正常に完了](media/azure-stack-monitor-health/repair-completed.png)

### <a name="manual-remediation"></a>手動による修復

**[修復]** オプションがサポートされていない場合は、アラートに示されている一連の修復手順のすべてに従ってください。 たとえば、内部証明書の有効期限の修復手順に従って、シークレット ローテーションのプロセスを実行します。

![証明書の有効期限の修復](media/azure-stack-monitor-health/certificate-expiration.png)

### <a name="alert-closure"></a>アラートを閉じる

根本的な問題が解決されると、多くのアラートは自動的に閉じます (すべてのアラートがそうなるわけではありません)。 [修復] アクションのボタンが用意されているアラートは、Azure Stack Hub によって問題が解決されると自動的に閉じます。 その他すべてのアラートについては、修復手順を実行した後、**[アラートを閉じる]** を選択してください。 問題が解決されなかった場合は、Azure Stack Hub で新しいアラートが生成されます。 問題が解決した場合は、アラートが閉じたままとなり、それ以上の手順は不要となります。

## <a name="next-steps"></a>次のステップ

[Azure Stack Hub での更新プログラム管理](azure-stack-updates.md)

[Azure Stack Hub でのリージョンの管理](azure-stack-region-management.md)
